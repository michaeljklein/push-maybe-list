<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lib</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- | The &quot;natural&quot; partition of a list of `Maybe`'s:</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- we group `Nothing`'s and `Just`'s and the outermost `Maybe`</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- marks which is contained.</span><span>
</span><a name="line-11"></a><span class="hs-identifier">partMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023703"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023703"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-12"></a><a name="partMaybes"><a href="Lib.html#partMaybes"><span class="hs-identifier">partMaybes</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-13"></a><span class="hs-identifier">partMaybes</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023704"><a href="#local-6989586621679023704"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023705"><a href="#local-6989586621679023705"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023704"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023706"><span class="hs-identifier hs-var">loopn</span></a><span> </span><a href="#local-6989586621679023705"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023924"><a href="#local-6989586621679023924"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023707"><span class="hs-identifier hs-var">loopj</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023924"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679023705"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-identifier">loopn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023708"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023708"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-19"></a><span>    </span><a name="local-6989586621679023706"><a href="#local-6989586621679023706"><span class="hs-identifier">loopn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-identifier">loopn</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023710"><a href="#local-6989586621679023710"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023711"><a href="#local-6989586621679023711"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023710"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-21"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023706"><span class="hs-identifier hs-var">loopn</span></a><span> </span><a href="#local-6989586621679023711"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-22"></a><span>      </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023712"><a href="#local-6989586621679023712"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023707"><span class="hs-identifier hs-var">loopj</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023712"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679023711"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023709"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023709"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023709"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-25"></a><span>    </span><a name="local-6989586621679023707"><a href="#local-6989586621679023707"><span class="hs-identifier">loopj</span></a></a><span> </span><a name="local-6989586621679023713"><a href="#local-6989586621679023713"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679023713"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">]</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><a name="local-6989586621679023920"><a href="#local-6989586621679023920"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023921"><a href="#local-6989586621679023921"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023922"><a href="#local-6989586621679023922"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023921"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-27"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679023920"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023706"><span class="hs-identifier hs-var">loopn</span></a><span> </span><a href="#local-6989586621679023922"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-28"></a><span>      </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023923"><a href="#local-6989586621679023923"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023707"><span class="hs-identifier hs-var">loopj</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023923"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023920"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023922"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Convert the &quot;natural&quot; partition into a partition that</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- we can more easily push through the innermost `Maybe`:</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- replace `Nothing`'s with an empty lists and drop `Just`'s.</span><span>
</span><a name="line-34"></a><span class="hs-identifier">unMaybeParts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023702"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023702"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-35"></a><a name="unMaybeParts"><a href="Lib.html#unMaybeParts"><span class="hs-identifier">unMaybeParts</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-36"></a><span class="hs-identifier">unMaybeParts</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023925"><a href="#local-6989586621679023925"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023926"><a href="#local-6989586621679023926"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023925"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-37"></a><span>                         </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023928"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023926"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-38"></a><span>                         </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023934"><a href="#local-6989586621679023934"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023934"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023927"><span class="hs-identifier hs-var">loopn</span></a><span> </span><a href="#local-6989586621679023926"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-40"></a><span>    </span><a name="local-6989586621679023927"><a href="#local-6989586621679023927"><span class="hs-identifier">loopn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-identifier">loopn</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679023929"><a href="#local-6989586621679023929"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023928"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023929"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>    </span><a name="local-6989586621679023928"><a href="#local-6989586621679023928"><span class="hs-identifier">loopj</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679023930"><a href="#local-6989586621679023930"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023930"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-45"></a><span>                  </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023931"><a href="#local-6989586621679023931"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023931"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023932"><a href="#local-6989586621679023932"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679023933"><a href="#local-6989586621679023933"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023932"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023928"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023933"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | @`unMaybeParts` . `partMaybes`@</span><span>
</span><a name="line-49"></a><span class="hs-identifier">partMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023701"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023701"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-50"></a><a name="partMaybe"><a href="Lib.html#partMaybe"><span class="hs-identifier">partMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#unMaybeParts"><span class="hs-identifier hs-var">unMaybeParts</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lib.html#partMaybes"><span class="hs-identifier hs-var">partMaybes</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | Reassociate the list and `Maybe`</span><span>
</span><a name="line-53"></a><span class="hs-identifier">dartMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023700"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023700"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-54"></a><a name="dartMaybe"><a href="Lib.html#dartMaybe"><span class="hs-identifier">dartMaybe</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span class="hs-identifier">dartMaybe</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023935"><a href="#local-6989586621679023935"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023936"><a href="#local-6989586621679023936"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023935"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023938"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023936"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-57"></a><span>  </span><a name="local-6989586621679023947"><a href="#local-6989586621679023947"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023948"><a href="#local-6989586621679023948"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023948"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679023947"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023937"><span class="hs-identifier hs-var">loopn</span></a><span> </span><a href="#local-6989586621679023936"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-58"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-identifier">loopn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-60"></a><span>    </span><a name="local-6989586621679023937"><a href="#local-6989586621679023937"><span class="hs-identifier">loopn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier">loopn</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679023941"><a href="#local-6989586621679023941"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023938"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023941"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-64"></a><span>    </span><a name="local-6989586621679023938"><a href="#local-6989586621679023938"><span class="hs-identifier">loopj</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679023942"><a href="#local-6989586621679023942"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023943"><a href="#local-6989586621679023943"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023943"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679023942"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-identifier">loopj</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679023944"><a href="#local-6989586621679023944"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679023945"><a href="#local-6989586621679023945"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679023946"><a href="#local-6989586621679023946"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023946"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679023944"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023938"><span class="hs-identifier hs-var">loopj</span></a><span> </span><a href="#local-6989586621679023945"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">-- | @`dartMaybe` . `partMaybe`@</span><span>
</span><a name="line-69"></a><span class="hs-identifier">pushMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023699"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023699"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-70"></a><a name="pushMaybe"><a href="Lib.html#pushMaybe"><span class="hs-identifier">pushMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#dartMaybe"><span class="hs-identifier hs-var">dartMaybe</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lib.html#partMaybe"><span class="hs-identifier hs-var">partMaybe</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- Tests</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- | Convert from pushed preserving `Nothing`'s</span><span>
</span><a name="line-76"></a><span class="hs-identifier">fromPushed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023698"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023698"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-77"></a><a name="fromPushed"><a href="Lib.html#fromPushed"><span class="hs-identifier">fromPushed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Just</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Replace runs of multiple `Nothing`'s with single `Nothing`'s</span><span>
</span><a name="line-80"></a><span class="hs-identifier">simplifyNothings</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023697"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023697"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-81"></a><a name="simplifyNothings"><a href="Lib.html#simplifyNothings"><span class="hs-identifier">simplifyNothings</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span class="hs-identifier">simplifyNothings</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679024937"><a href="#local-6989586621679024937"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024938"><a href="#local-6989586621679024938"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679024937"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024939"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679024938"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-85"></a><span>    </span><a name="local-6989586621679024942"><a href="#local-6989586621679024942"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024942"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Lib.html#simplifyNothings"><span class="hs-identifier hs-var">simplifyNothings</span></a><span> </span><a href="#local-6989586621679024938"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-6989586621679024939"><a href="#local-6989586621679024939"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679024940"><a href="#local-6989586621679024940"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024941"><a href="#local-6989586621679024941"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-89"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679024940"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-90"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024939"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679024941"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-91"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024940"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Lib.html#simplifyNothings"><span class="hs-identifier hs-var">simplifyNothings</span></a><span> </span><a href="#local-6989586621679024941"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- | @`fromPushed` . `pushMaybe` == `simplifyNothings`@</span><span>
</span><a name="line-94"></a><span class="hs-identifier">fromPushedIsSimplified</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679023696"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023696"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-95"></a><a name="fromPushedIsSimplified"><a href="Lib.html#fromPushedIsSimplified"><span class="hs-identifier">fromPushedIsSimplified</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#fromPushed"><span class="hs-identifier hs-var">fromPushed</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lib.html#pushMaybe"><span class="hs-identifier hs-var">pushMaybe</span></a><span class="hs-special">)</span><span> </span><a href="Lib.html#simplifyNothings"><span class="hs-identifier hs-var">simplifyNothings</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- | Drop the `Nothing`'s and flatten the resulting list</span><span>
</span><a name="line-98"></a><span class="hs-identifier">flattenPushed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023695"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023695"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-99"></a><a name="flattenPushed"><a href="Lib.html#flattenPushed"><span class="hs-identifier">flattenPushed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">maybeToList</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- | @`flattenPushed` . `pushMaybe` == `catMaybes`@</span><span>
</span><a name="line-102"></a><span class="hs-identifier">flattenPushedIsCatMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679023694"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023694"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-103"></a><a name="flattenPushedIsCatMaybes"><a href="Lib.html#flattenPushedIsCatMaybes"><span class="hs-identifier">flattenPushedIsCatMaybes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#flattenPushed"><span class="hs-identifier hs-var">flattenPushed</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lib.html#pushMaybe"><span class="hs-identifier hs-var">pushMaybe</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- Test helpers</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | To a reversed list of he binary digits of the input</span><span>
</span><a name="line-110"></a><span class="hs-identifier">toBin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679023693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679023693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679023693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679023693"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-111"></a><a name="toBin"><a href="Lib.html#toBin"><span class="hs-identifier">toBin</span></a></a><span> </span><a name="local-6989586621679024943"><a href="#local-6989586621679024943"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679024943"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679024943"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-115"></a><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024943"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Lib.html#toBin"><span class="hs-identifier hs-var">toBin</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024943"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">unsafeShiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | If `False` then `Nothing` else `Just`, zipped</span><span>
</span><a name="line-119"></a><span class="hs-identifier">toMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023692"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679023692"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-120"></a><a name="toMaybes"><a href="Lib.html#toMaybes"><span class="hs-identifier">toMaybes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679024944"><a href="#local-6989586621679024944"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024945"><a href="#local-6989586621679024945"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679024944"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-123"></a><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679024945"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-124"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Use `toBin` to get the list of `Bool`'s and use @[1..]@ as</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- the list of values. The first argument is the length and the</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- second is the index.</span><span>
</span><a name="line-129"></a><span class="hs-identifier">enumMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bits</span><span> </span><a href="#local-6989586621679019285"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679019285"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679019285"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679019285"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679019285"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-130"></a><a name="enumMaybes"><a href="Lib.html#enumMaybes"><span class="hs-identifier">enumMaybes</span></a></a><span> </span><a name="local-6989586621679024946"><a href="#local-6989586621679024946"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024947"><a href="#local-6989586621679024947"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>  </span><a href="Lib.html#toMaybes"><span class="hs-identifier hs-var">toMaybes</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679024946"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#toBin"><span class="hs-identifier hs-var">toBin</span></a><span> </span><a href="#local-6989586621679024947"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Apply a test to `enumMaybes` up to the given maximums.</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- Return any counterexamples.</span><span>
</span><a name="line-135"></a><span class="hs-identifier">testEnumMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-136"></a><a name="testEnumMaybes"><a href="Lib.html#testEnumMaybes"><span class="hs-identifier">testEnumMaybes</span></a></a><span> </span><a name="local-6989586621679024948"><a href="#local-6989586621679024948"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679024949"><a href="#local-6989586621679024949"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024950"><a href="#local-6989586621679024950"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679024953"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679024951"><a href="#local-6989586621679024951"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679024949"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679024952"><a href="#local-6989586621679024952"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679024950"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024953"><a href="#local-6989586621679024953"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#enumMaybes"><span class="hs-identifier hs-var">enumMaybes</span></a><span> </span><a href="#local-6989586621679024951"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024952"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679024948"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679024953"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Throw an error if the test fails on any input `enumMaybes`</span><span>
</span><a name="line-140"></a><span class="hs-identifier">assertEnumMaybes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><a name="assertEnumMaybes"><a href="Lib.html#assertEnumMaybes"><span class="hs-identifier">assertEnumMaybes</span></a></a><span> </span><a name="local-6989586621679024954"><a href="#local-6989586621679024954"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679024955"><a href="#local-6989586621679024955"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679024956"><a href="#local-6989586621679024956"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024957"><a href="#local-6989586621679024957"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Test name: &quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679024954"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Lib.html#testEnumMaybes"><span class="hs-identifier hs-var">testEnumMaybes</span></a><span> </span><a href="#local-6989586621679024955"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679024956"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024957"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-145"></a><span>      </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-146"></a><span>        </span><span class="hs-identifier hs-var">concat</span><span>
</span><a name="line-147"></a><span>          </span><span class="hs-special">[</span><span class="hs-string">&quot;Passed test with i &lt;- [0..&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679024956"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;], j &lt;- [0..&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679024957"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-148"></a><span>      </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-6989586621679025977"><a href="#local-6989586621679025977"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Test failed on: &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679025977"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-identifier">runTests</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><a name="runTests"><a href="Lib.html#runTests"><span class="hs-identifier">runTests</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-153"></a><span>  </span><a href="Lib.html#assertEnumMaybes"><span class="hs-identifier hs-var">assertEnumMaybes</span></a><span> </span><span class="hs-string">&quot;fromPushedIsSimplified&quot;</span><span> </span><a href="Lib.html#fromPushedIsSimplified"><span class="hs-identifier hs-var">fromPushedIsSimplified</span></a><span> </span><span class="hs-number">100</span><span> </span><span class="hs-number">100</span><span>
</span><a name="line-154"></a><span>  </span><a href="Lib.html#assertEnumMaybes"><span class="hs-identifier hs-var">assertEnumMaybes</span></a><span> </span><span class="hs-string">&quot;flattenPushedIsCatMaybes&quot;</span><span> </span><a href="Lib.html#flattenPushedIsCatMaybes"><span class="hs-identifier hs-var">flattenPushedIsCatMaybes</span></a><span> </span><span class="hs-number">100</span><span> </span><span class="hs-number">100</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;All tests passed!&quot;</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Notes on digraphs:</span><span>
</span><a name="line-159"></a><span class="hs-comment">--</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-161"></a><span class="hs-comment">--  newtype Digraph = Digraph { digraphMatrix :: Matrix Bool }</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">--  data DigraphGen = DigraphGen</span><span>
</span><a name="line-164"></a><span class="hs-comment">--    { currentDigraph :: Digraph</span><span>
</span><a name="line-165"></a><span class="hs-comment">--    , currentArc :: Arc</span><span>
</span><a name="line-166"></a><span class="hs-comment">--    , newDigraph :: Bool</span><span>
</span><a name="line-167"></a><span class="hs-comment">--    }</span><span>
</span><a name="line-168"></a><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span class="hs-comment">--  We can enumerate the non (i, i) arcs in (join liftM2 (,) [1..n])</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">--  this gives us an Enum instance for (ArcN (n :: Nat))</span><span>
</span><a name="line-172"></a><span class="hs-comment">--</span><span>
</span><a name="line-173"></a><span class="hs-comment">--  newtype ArcN (n :: Nat) = ArcN { toArc :: Arc }</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-175"></a><span class="hs-comment">--</span><span>
</span><a name="line-176"></a><span class="hs-identifier">digraphNotes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><a name="digraphNotes"><a href="Lib.html#digraphNotes"><span class="hs-identifier">digraphNotes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a></pre></body></html>